import React, { useState, useEffect } from 'react';
import { showNotification, NotificationProps } from '@mantine/notifications';
import { IconWifi, IconWifiOff } from '@tabler/icons-react';

const useOnlineStatus = (): boolean => {
  const [isOnline, setIsOnline] = useState<boolean>(navigator.onLine);

  useEffect(() => {
    const createNotification = (
      isOnline: boolean
    ): NotificationProps => ({
      title: isOnline ? 'Connected' : 'Offline',
      message: isOnline ? 'Back online' : 'Working in offline mode',
      color: isOnline ? 'green' : 'yellow',
      icon: <>{isOnline ? <IconWifi size={16} /> : <IconWifiOff size={16} />}</>
    });

    const handleOnline = () => {
      setIsOnline(true);
      showNotification(createNotification(true));
    };

    const handleOffline = () => {
      setIsOnline(false);
      showNotification(createNotification(false));
    };

    window.addEventListener('online', handleOnline);
    window.addEventListener('offline', handleOffline);

    return () => {
      window.removeEventListener('online', handleOnline);
      window.removeEventListener('offline', handleOffline);
    };
  }, []);

  // Explicit return to satisfy TypeScript
  return isOnline;
};

export default useOnlineStatus;
